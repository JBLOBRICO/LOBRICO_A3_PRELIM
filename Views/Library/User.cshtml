@model List<LOBRICO_A3_PRELIM.Models.ViewModels.BorrowerViewModel>

@{
    ViewData["Title"] = "📋 Borrowers and Their Borrowed Books";
}

<style>
    body {
        background-color: #f5f7fa;
    }

    .borrower-card {
        background-color: #ffffff;
        border: 1px solid #e0e0e0;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        transition: 0.3s ease;
    }

        .borrower-card:hover {
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

    .borrower-header {
        background-color: #eef3f8;
        color: #2d3e50;
        padding: 15px 25px;
        border-bottom: 1px solid #dee2e6;
        border-radius: 12px 12px 0 0;
    }

        .borrower-header h5 {
            margin: 0;
            font-weight: 600;
        }

        .borrower-header small {
            color: #6c757d;
        }

    .table thead {
        background-color: #f1f3f5;
        color: #495057;
    }

    .table-hover tbody tr:hover {
        background-color: #f9f9fc;
    }

    .badge-soft-borrowed {
        background-color: #fff3cd;
        color: #856404;
        font-weight: 500;
        border-radius: 6px;
        padding: 4px 10px;
    }

    .badge-soft-returned {
        background-color: #d4edda;
        color: #155724;
        font-weight: 500;
        border-radius: 6px;
        padding: 4px 10px;
    }

    h2.title {
        font-weight: 600;
        color: #34495e;
        margin-bottom: 30px;
    }
</style>

<div class="container mt-5">
    <h2 class="text-center title">@ViewData["Title"]</h2>

    @foreach (var user in Model)
    {
        <div class="borrower-card mb-4">
            <div class="borrower-header">
                <h5>👤 @user.Username</h5>
                <small>@user.Email</small>
            </div>

            <div class="p-4">
                @if (user.BorrowedBooks != null && user.BorrowedBooks.Any())
                {
                    <div class="table-responsive">
                        <table class="table table-bordered table-hover text-center align-middle">
                            <thead>
                                <tr>
                                    <th>📚 Title</th>
                                    <th>✍️ Author</th>
                                    <th>📅 Borrowed Date</th>
                                    <th>📆 Return Date</th>
                                    <th>📌 Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var book in user.BorrowedBooks)
                                {
                                    <tr>
                                        <td class="text-start">@book.Title</td>
                                        <td>@book.AuthorName</td>
                                        <td>@(book.BorrowedDate?.ToString("MMM dd, yyyy") ?? "-")</td>
                                        <td>@(book.ReturnDate?.ToString("MMM dd, yyyy") ?? "-")</td>
                                        <td>
                                            @if (book.Status == "Borrowed")
                                            {
                                                <span class="badge-soft-borrowed">Borrowed</span>
                                            }
                                            else
                                            {
                                                <span class="badge-soft-returned">Returned</span>
                                            }
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                }
                else
                {
                    <div class="alert alert-secondary mt-3 mb-0">
                        <em>This user hasn't borrowed any books yet.</em>
                    </div>
                }
            </div>
        </div>
    }
</div>
